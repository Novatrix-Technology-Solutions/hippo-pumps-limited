import{r as n,n as H,K as Q,y as _,k as ee,A as x,o as C,a as re,R as h,O as ve,s as he,p as me,H as P,u as ne,x as pe,b as be,l as ge,I as Re,i as Te}from"./app-CUw2shSB.js";import{l as te}from"./use-server-handoff-complete-Cw6g5RoP.js";function Ce(){let e=n.useRef(!1);return H(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function le(e){var r;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||((r=e.as)!=null?r:se)!==n.Fragment||h.Children.count(e.children)===1}let U=n.createContext(null);U.displayName="TransitionContext";var Ee=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Ee||{});function we(){let e=n.useContext(U);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function $e(){let e=n.useContext(j);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let j=n.createContext(null);j.displayName="NestingContext";function z(e){return"children"in e?z(e.children):e.current.filter(({el:r})=>r.current!==null).filter(({state:r})=>r==="visible").length>0}function ie(e,r){let l=he(e),a=n.useRef([]),E=Ce(),S=me(),m=C((s,t=P.Hidden)=>{let u=a.current.findIndex(({el:i})=>i===s);u!==-1&&(ne(t,{[P.Unmount](){a.current.splice(u,1)},[P.Hidden](){a.current[u].state="hidden"}}),S.microTask(()=>{var i;!z(a)&&E.current&&((i=l.current)==null||i.call(l))}))}),w=C(s=>{let t=a.current.find(({el:u})=>u===s);return t?t.state!=="visible"&&(t.state="visible"):a.current.push({el:s,state:"visible"}),()=>m(s,P.Unmount)}),b=n.useRef([]),f=n.useRef(Promise.resolve()),p=n.useRef({enter:[],leave:[]}),g=C((s,t,u)=>{b.current.splice(0),r&&(r.chains.current[t]=r.chains.current[t].filter(([i])=>i!==s)),r==null||r.chains.current[t].push([s,new Promise(i=>{b.current.push(i)})]),r==null||r.chains.current[t].push([s,new Promise(i=>{Promise.all(p.current[t].map(([$,y])=>y)).then(()=>i())})]),t==="enter"?f.current=f.current.then(()=>r==null?void 0:r.wait.current).then(()=>u(t)):u(t)}),R=C((s,t,u)=>{Promise.all(p.current[t].splice(0).map(([i,$])=>$)).then(()=>{var i;(i=b.current.shift())==null||i()}).then(()=>u(t))});return n.useMemo(()=>({children:a,register:w,unregister:m,onStart:g,onStop:R,wait:f,chains:p}),[w,m,a,g,R,p,f])}let se=n.Fragment,ue=ve.RenderStrategy;function Fe(e,r){var l,a;let{transition:E=!0,beforeEnter:S,afterEnter:m,beforeLeave:w,afterLeave:b,enter:f,enterFrom:p,enterTo:g,entered:R,leave:s,leaveFrom:t,leaveTo:u,...i}=e,[$,y]=n.useState(null),o=n.useRef(null),T=le(e),F=_(...T?[o,r,y]:r===null?[]:[r]),V=(l=i.unmount)==null||l?P.Unmount:P.Hidden,{show:d,appear:W,initial:X}=we(),[v,D]=n.useState(d?"visible":"hidden"),Y=$e(),{register:O,unregister:N}=Y;H(()=>O(o),[O,o]),H(()=>{if(V===P.Hidden&&o.current){if(d&&v!=="visible"){D("visible");return}return ne(v,{hidden:()=>N(o),visible:()=>O(o)})}},[v,o,O,N,d,V]);let k=te();H(()=>{if(T&&k&&v==="visible"&&o.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[o,v,k,T]);let oe=X&&!W,Z=W&&d&&X,K=n.useRef(!1),I=ie(()=>{K.current||(D("hidden"),N(o))},Y),q=C(B=>{K.current=!0;let M=B?"enter":"leave";I.onStart(o,M,L=>{L==="enter"?S==null||S():L==="leave"&&(w==null||w())})}),J=C(B=>{let M=B?"enter":"leave";K.current=!1,I.onStop(o,M,L=>{L==="enter"?m==null||m():L==="leave"&&(b==null||b())}),M==="leave"&&!z(I)&&(D("hidden"),N(o))});n.useEffect(()=>{T&&E||(q(d),J(d))},[d,T,E]);let ce=!(!E||!T||!k||oe),[,c]=pe(ce,$,d,{start:q,end:J}),de=be({ref:F,className:((a=Re(i.className,Z&&f,Z&&p,c.enter&&f,c.enter&&c.closed&&p,c.enter&&!c.closed&&g,c.leave&&s,c.leave&&!c.closed&&t,c.leave&&c.closed&&u,!c.transition&&d&&R))==null?void 0:a.trim())||void 0,...ge(c)}),A=0;v==="visible"&&(A|=x.Open),v==="hidden"&&(A|=x.Closed),d&&v==="hidden"&&(A|=x.Opening),!d&&v==="visible"&&(A|=x.Closing);let fe=re();return h.createElement(j.Provider,{value:I},h.createElement(Te,{value:A},fe({ourProps:de,theirProps:i,defaultTag:se,features:ue,visible:v==="visible",name:"Transition.Child"})))}function Pe(e,r){let{show:l,appear:a=!1,unmount:E=!0,...S}=e,m=n.useRef(null),w=le(e),b=_(...w?[m,r]:r===null?[]:[r]);te();let f=ee();if(l===void 0&&f!==null&&(l=(f&x.Open)===x.Open),l===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[p,g]=n.useState(l?"visible":"hidden"),R=ie(()=>{l||g("hidden")}),[s,t]=n.useState(!0),u=n.useRef([l]);H(()=>{s!==!1&&u.current[u.current.length-1]!==l&&(u.current.push(l),t(!1))},[u,l]);let i=n.useMemo(()=>({show:l,appear:a,initial:s}),[l,a,s]);H(()=>{l?g("visible"):!z(R)&&m.current!==null&&g("hidden")},[l,R]);let $={unmount:E},y=C(()=>{var F;s&&t(!1),(F=e.beforeEnter)==null||F.call(e)}),o=C(()=>{var F;s&&t(!1),(F=e.beforeLeave)==null||F.call(e)}),T=re();return h.createElement(j.Provider,{value:R},h.createElement(U.Provider,{value:i},T({ourProps:{...$,as:n.Fragment,children:h.createElement(ae,{ref:b,...$,...S,beforeEnter:y,beforeLeave:o})},theirProps:{},defaultTag:n.Fragment,features:ue,visible:p==="visible",name:"Transition"})))}function Se(e,r){let l=n.useContext(U)!==null,a=ee()!==null;return h.createElement(h.Fragment,null,!l&&a?h.createElement(G,{ref:r,...e}):h.createElement(ae,{ref:r,...e}))}let G=Q(Pe),ae=Q(Fe),xe=Q(Se),Ae=Object.assign(G,{Child:xe,Root:G});export{Ae as z};
